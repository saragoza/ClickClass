$(document).ready(function(){$.ajaxPrefilter(function(options,originalOptions,xhr){var token=$('meta[name="csrf-token"]').attr('content');if(token){return xhr.setRequestHeader('X-CSRF-TOKEN',token)}});$(function(){$('#myDocsTable').DataTable({retrieve:!0,processing:!0,serverSide:!0,ajax:'/mylist',columns:[{data:'id',name:'id'},{data:'filename',name:'filename'},{data:'description',name:'description'},{data:'type',name:'type'},{data:'tags',name:'tags',visible:!1},{data:'owner',className:'text-center',render:function(data){var buttons="<button class='detalle btn-link btn-xs'>Detalle</button><button class='descargar btn-link btn-xs'>Descargar</button><button class='editar btn-link btn-xs'>Editar</button>";var userAuth=$('#userAuth').val();if(data==userAuth){buttons+="<button type='button' class='permisos btn-link btn-xs'>Permisos</button><button class='eliminar btn-link btn-xs'>Eliminar</button>"}
else{buttons+="<button class='permisos btn-link btn-xs' style='color:#DDD' disabled>Permisos</button><button class='eliminar btn-link btn-xs' style='color:#DDD' disabled>Eliminar</button>"}
return buttons}}],'language':{"url":"/datatablesEs"},"oAria":{"sSortAscending":": Activar para ordenar la columna de manera ascendente","sSortDescending":": Activar para ordenar la columna de manera descendente"}})});$('#myDocsTable').on('click','.detalle',function(e){e.preventDefault();var myDocsTable=$('#myDocsTable').DataTable();var dRow=$(this).parents('tr')[0];var dData=myDocsTable.row(dRow).data();var id=dData.id;var urlDetalle='/docs/show/'+id;window.location=urlDetalle});$('#myDocsTable').on('click','.descargar',function(e){e.preventDefault();var myDocsTable=$('#myDocsTable').DataTable();var dRow=$(this).parents('tr')[0];var dData=myDocsTable.row(dRow).data();var id=dData.id;var urlDescargar='/docs/download/'+id;window.location=urlDescargar});$('#myDocsTable').on('click','.editar',function(e){e.preventDefault();var myDocsTable=$('#myDocsTable').DataTable();var dRow=$(this).parents('tr')[0];var dData=myDocsTable.row(dRow).data();var id=dData.id;var urlEditar='/docs/edit/'+id;window.location=urlEditar});$('#myDocsTable').on('click','.permisos',function(e){e.preventDefault();var myDocsTable=$('#myDocsTable').DataTable();var dRow=$(this).parents('tr')[0];var dData=myDocsTable.row(dRow).data();var id=dData.id;var urlPermisos='/perms/show/'+id;window.location=urlPermisos});$('#myDocsTable').on('click','.eliminar',function(e){e.preventDefault();var myDocsTable=$('#myDocsTable').DataTable();var dRow=$(this).parents('tr')[0];var dData=myDocsTable.row(dRow).data();var ok=confirm("¿Desea eliminar el archivo?");if(ok){var id=dData.id;$.ajax({type:'post',url:'/docs/delete',data:{id:id},success:function(data){myDocsTable.row(dRow).remove();myDocsTable.draw();alert("Archivo eliminado con éxito")},error:function(data){alert("Error al eliminar el archivo")},complete:{}})}})})
